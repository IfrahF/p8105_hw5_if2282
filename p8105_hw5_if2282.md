Homework 5
================
Ifrah Fayyaz
11/11/2021

## Loading libraries:

``` r
library(tidyverse)
library(rvest)
```

# Problem 2

``` r
prob2 = tibble(
  filename = list.files("./data/")
  )

con_exp = function(path) {
  df = tibble(
    obs = path %>%
       map(read_csv))
}

prob2 = prob2 %>%
  mutate(filepath = paste0("./data/", filename)) 

prob2 = prob2 %>%
  mutate(con_exp(prob2$filepath)) %>%
  select(-filepath)


prob2_tidy = 
  prob2 %>%
  unnest() 

prob2_tidy = prob2_tidy %>%
  pivot_longer(
    week_1:week_8,
    names_to = "weeks",
    values_to = "obs"
  ) %>%
  rename(subject_id = filename) %>%
  mutate(subject_id = sub("\\..*", "", subject_id)) %>%
  mutate(arm = sub("\\_.*", "", subject_id)) 

ggplot(data = prob2_tidy, aes(x = weeks, y = obs, group = subject_id, color = arm)) + 
  geom_line() +
  labs(
    title = "Observations over time",
    x = "Weeks",
    y = "Observations"
  ) + 
  scale_colour_discrete(name = "Study Arm: ", labels = c("Control", "Experimental")) + 
    theme(legend.position = "bottom")
```

![](p8105_hw5_if2282_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->

**Description:** The spaghetti plot above shows the observations of 20
subjects over time - 10 registered in the control arm and 10 in the
experimental arm. We can see visible differences between groups where
participants in the control arm show lower observations than the
participants in the experimental arm that show an increasing trend in
their observations. The observations of the participants in the control
arm do not show any increasing or decreasing trends over time.
