---
title: "Homework 5"
author: "Ifrah Fayyaz"
date: "11/11/2021"
output: github_document
---

## Loading libraries:

```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(rvest)
```


# Problem 1

```{r, message=FALSE, warning=FALSE}
prob1 = read_csv("homicide-data.csv")

```

**Description:**
The homicide dataset contains ``r ncol(prob1)`` variables and ``r nrow(prob1)`` observations. It contains victim characteristics such as victim's full name (`victim_first` and `victim_last`), age (`victim_age`) and sex (`victim_sex`). The homicide data contained is for the ``r prob1 %>% pull(city) %>% n_distinct()`` cities and ``r prob1 %>% pull(state) %>% n_distinct()`` states, with ``r prob1 %>% count(city, sort = TRUE) %>% slice(1:3) %>% pull(city)`` having the most reported homicide cases. 


```{r, message=FALSE, warning=FALSE}

```

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

# Problem 2

```{r, message=FALSE, warning=FALSE, dpi=300}
prob2 = tibble(
  filename = list.files("./data/")
  )

con_exp = function(path) {
  df = tibble(
    obs = path %>%
       map(read_csv))
}

prob2 = prob2 %>%
  mutate(filepath = paste0("./data/", filename)) 

prob2 = prob2 %>%
  mutate(con_exp(prob2$filepath)) %>%
  select(-filepath)


prob2_tidy = 
  prob2 %>%
  unnest() 

prob2_tidy = prob2_tidy %>%
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    values_to = "obs"
  ) %>%
  rename(subject_id = filename) %>%
  mutate(subject_id = sub("\\..*", "", subject_id)) %>%
  mutate(arm = sub("\\_.*", "", subject_id)) %>%
  mutate(week = sub('.*\\_', '', week)) 

ggplot(data = prob2_tidy, aes(x = week, y = obs, group = subject_id, color = arm)) + 
  geom_line() +
  labs(
    title = "Observations over time",
    x = "Weeks",
    y = "Observations"
  ) + 
  scale_colour_discrete(name = "Study Arm: ", labels = c("Control", "Experimental")) + 
    theme(legend.position = "bottom")

```

**Description:**
The spaghetti plot above shows the observations of 20 subjects over time - 10 registered in the control arm and 10 in the experimental arm. We can see visible differences between groups where participants in the control arm show lower observations than the participants in the experimental arm that show an increasing trend in their observations. The observations of the participants in the control arm do not show any increasing or decreasing trends over time. 


```{r}








```




```{r, message=FALSE, warning=FALSE}

```


```{r, message=FALSE, warning=FALSE}

```


```{r, message=FALSE, warning=FALSE}

```

